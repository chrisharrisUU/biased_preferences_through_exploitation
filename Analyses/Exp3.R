### Setup----
# Dependencies
if (!require(needs)) {install.packages("needs"); library(needs)}
if (!require(goallabr)) {
  if (!require(devtools)) {install.packages("devtools"); library(devtools)}
  install_github("chrisharrisUU/goallabr")
}
needs(dplyr, magrittr, ggplot2, here, tidyr, gridExtra, BayesFactor, papaja, purrr, goallabr, lme4, lmerTest)
prioritize(dplyr)

source(here("Auxiliary/Exp3_init.R"))

### Functions----
source(here("Auxiliary/functions.R"))

### Canonical sorting----
df3 <- do_counterbalance_3(df3)

# Include switching
df3 <- switching(df3, 17)

# Make preference binary
df3 %<>%
  mutate(binaryprepref = ifelse(prepref_dom > 0,
                                1,
                                ifelse(prepref_dom < 0, 0, NA)),
         binarypostpref = ifelse(postpref_dom > 0,
                                 1,
                                 ifelse(postpref_dom < 0, 0, NA))) %>%
  mutate(binarypostpref = factor(binarypostpref, levels = c(1, 0)),
         binaryprepref = factor(binaryprepref, levels = c(1, 0)))

### Demographic data----
# Summary of most relevant demographic data
df3 %>%
  mutate(age = as.integer(as.character(age))) %>%
  summarise(N = n(),
            female = length(which(gender == "female")),
            age_mean = mean(age, na.rm = TRUE),
            age_sd = sd(age, na.rm = TRUE))

# Level of education
df3 %>%
  group_by(edu) %>%
  summarise(count = length(edu))
# Percentage degree
length(which(as.integer(df3$edu) > 2)) / nrow(df3)

### Relative preference estimates pre----

## Continuous
# Graph
df3 %>%
  ggplot(aes(x = condition,
             y = prepref_freq,
             fill = condition)) +
  geom_violin() + 
  geom_boxplot(width = 0.2) +
  geom_jitter(size = 0.5, width = 0.2) +
  geom_hline(yintercept = 0, linetype = 2) +
  scale_fill_brewer(palette = "Dark2") +
  theme_apa() +
  labs(x = "Condition",
       y = "Relative preference estimates - pre-measure") +
  theme(legend.position = "none")

# Means and sds
df3 %>%
  # group_by(condition) %>%
  summarise(post_avg = printnum(mean(prepref_freq)),
            post_SD = printnum(sd(prepref_freq)))

# Tests
df3 %>%
  as.data.frame() %$%
  ttestBF(data = .,
          formula = prepref_freq ~ condition,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = prepref_freq,
      x = condition,
      dir = "two.sided")

ttestBF(
  df3$prepref_freq,
  mu = 0,
  nullInterval = c(0, Inf)
) %>% printBFt()
ttest(data = df3,
      y = prepref_freq,
      x = condition,
      mu = 0,
      dir = "greater")

## Binary
# Distribution
distrpre <- df3 %$%
  table(binaryprepref, condition)
distrpre
length(which(is.na(df3$binaryprepref))) # excluded from binary analyses

# Tests
proportionBF(y = distrpre["1", "rich"],
             N = distrpre["1", "rich"] + distrpre["0", "rich"],
             p = distrpre["0", "impoverished"] / (distrpre["1", "impoverished"] + distrpre["0", "impoverished"]),
             rscale = "ultrawide",
             nullInterval = c(0, 1)) %>% printBFb()
binom.test(x = distrpre["1", "rich"],
           n = distrpre["1", "rich"] + distrpre["0", "rich"],
           p = distrpre["0", "impoverished"] / (distrpre["1", "impoverished"] + distrpre["0", "impoverished"]),
           alternative = "greater")

proportionBF(y = distrpre["1", "rich"] + distrpre["0", "impoverished"],
             N = distrpre["1", "rich"] + distrpre["0", "rich"] + distrpre["1", "impoverished"] + distrpre["0", "impoverished"],
             p = .5,
             rscale = "ultrawide",
             nullInterval = c(0, 1)) %>% printBFb()
binom.test(x = distrpre["1", "rich"] + distrpre["0", "impoverished"],
           n = distrpre["1", "rich"] + distrpre["0", "rich"] + distrpre["1", "impoverished"] + distrpre["0", "impoverished"],
           p = .5,
           alternative = "greater")

### Conditionals pre----
# Graph
df3 %>%
  ggplot(aes(x = condition,
             y = precond_dp,
             fill = condition)) +
  geom_violin() + 
  geom_boxplot(width = 0.2) +
  geom_jitter(size = 0.5, width = 0.2) +
  geom_hline(yintercept = 0, linetype = 2) +
  scale_fill_brewer(palette = "Dark2") +
  theme_apa() +
  labs(x = "Conditional estimates",
       y = expression(Delta*"p")) +
  theme(legend.position = "none")

# Summary statistics and tests
df3 %>%
  # xprecond2 -> How likely was it (in %) that you grabbed a *frequent* ball if...
  mutate(frequent = ifelse(primacy == "A", aprecond2, bprecond2),
         infrequent = ifelse(primacy == "A", bprecond2, aprecond2)) %>%
  # Summarize
  # group_by(condition) %>%
  summarize(pre_winning_rich = printnum(mean(frequent)),
            pre_losing_rich = printnum(mean(infrequent)),
            winning_bag_sd = printnum(sd(frequent)),
            losing_bag_sd = printnum(sd(infrequent)))

df3 %>%
  # group_by(condition) %>%
  summarize(post_avg = printnum(mean(precond_dp)),
            post_SD = printnum(sd(precond_dp)))

# Tests
df3 %>%
  as.data.frame() %$%
  ttestBF(data = .,
          formula = precond_dp ~ condition,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = precond_dp,
      x = condition,
      dir = "two.sided")

ttestBF(df3$precond_dp, mu = 0, nullInterval = c(0, Inf)) %>% printBFt()
ttest(data = df3,
      y = precond_dp,
      x = condition,
      mu = 0,
      dir = "greater")

### Confidence pre ----

# Means and sds
df3 %>%
  group_by(condition) %>%
  summarise(pre_avg = printnum(mean(preconf_dp)),
            pre_SD = printnum(sd(preconf_dp)))

# Inference tests
conf <- df3 %>%
  group_by(condition) %>%
  mutate(conf_pre_fr = ifelse(primacy == "A", apreconf2, bpreconf2),
         conf_pre_in = ifelse(primacy == "A", bpreconf2, apreconf2)) %>%
  ungroup %>%
  select(condition, conf_pre_fr, conf_pre_in) %>%
  pivot_longer(cols = c(conf_pre_fr, conf_pre_in),
               names_to = "type",
               values_to = "confidence")
conf %>%
  group_by(type) %>%
  summarize(avg = printnum(mean(confidence)),
            sd = printnum(sd(confidence)))
conf %>%
  as.data.frame() %$%
  ttestBF(data = .,
          formula = confidence ~ type,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
conf %>%
  ttest(data = .,
        y = confidence,
        x = type,
        dir = "two.sided")
rm(conf)

# Per condition
conf %>%
  filter(condition == "rich") %>%
  group_by(type) %>%
  summarize(avg = printnum(mean(confidence)),
            sd = printnum(sd(confidence)))
conf %>%
  filter(condition == "rich") %>%
  as.data.frame() %$%
  ttestBF(data = .,
          formula = confidence ~ type,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
conf %>%
  filter(condition == "rich") %>%
  ttest(data = .,
        y = confidence,
        x = type,
        dir = "two.sided")
rm(conf)

conf %>%
  filter(condition == "impoverished") %>%
  group_by(type) %>%
  summarize(avg = printnum(mean(confidence)),
            sd = printnum(sd(confidence)))
conf %>%
  filter(condition == "impoverished") %>%
  as.data.frame() %$%
  ttestBF(data = .,
          formula = confidence ~ type,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
conf %>%
  filter(condition == "impoverished") %>%
  ttest(data = .,
        y = confidence,
        x = type,
        dir = "two.sided")
rm(conf)
### Sampling----

## Comparisons of means

# Graph over trials
time_series(df3)
ggsave("Output/Graphs/Exp2_timeseries.svg", device = "svg")

# Graph
df3 %>%
    ggplot(aes(x = condition,
               y = choiceindex_per,
               fill = condition)) +
    geom_violin() + 
    geom_boxplot(width = 0.2) +
    geom_jitter(size = 0.5, width = 0.2) +
    geom_hline(yintercept = .5, linetype = 2) +
    scale_fill_brewer(palette = "Dark2") +
    theme_apa() +
    labs(x = " ",
         y = "Percentage frequent option over participants") +
    theme(legend.position = "none") +
    lims(y = c(-0.1, 1.1))
ggsave(filename = "Output/Graphs/Exp2_sampling.svg",
       device = "svg") # 9.08 x 5.72

# Means and sds
df3 %>%
  group_by(condition) %>%
  summarise(post_avg = printnum(100 * mean(choiceindex_per)),
            post_SD = printnum(100 * sd(choiceindex_per)))

# Tests
df3 %>%
  filter(condition == "rich") %>%
  as.data.frame() %$%
  ttestBF(choiceindex_per,
          mu = .5,
          nullInterval = c(0, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = choiceindex_per,
      x = condition,
      mu = .5,
      sub = "rich",
      dir = "greater")

df3 %>%
  filter(condition == "impoverished") %>%
  as.data.frame() %$%
  ttestBF(choiceindex_per,
          mu = .5,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = choiceindex_per,
      x = condition,
      mu = .5,
      sub = "impoverished",
      dir = "two.sided")

df3 %>%
  mutate(choiceindex_per = ifelse(condition == "rich", choiceindex_per, 1 - choiceindex_per)) %>%
  as.data.frame() %>%
  ttestBF(data = .,
          formula = choiceindex_per ~ condition,
          nullInterval = c(0, Inf)) %>%
  printBFt()
df3 %>%
  mutate(choiceindex_per = ifelse(condition == "rich", choiceindex_per, 1 - choiceindex_per)) %>%
  ttest(data = .,
      y = choiceindex_per,
      x = condition,
      dir = "greater")

## Comparisons over trials

# Intercepts
df3 %>%
  cb_lf_int() %>%
  mutate(value = ifelse(condition == "impoverished", value * (-1), value),
         trial = trial - 17) %>%
  mutate(value = ifelse(value < 0, 0, value),
         trial = trial / 100) %>%
  filter(condition == "rich") %>%
  glmer(value ~ 1 + trial + (1|participant.id),
        data = .,
        family = binomial) %>%
  summary()
df3 %>%
  cb_lf_int() %>%
  mutate(value = ifelse(condition == "impoverished", value * (-1), value),
         trial = trial - 17) %>%
  mutate(value = ifelse(value < 0, 0, value),
         trial = trial / 100) %>%
  filter(condition == "impoverished") %>%
  glmer(value ~ 1 + trial + (1|participant.id),
        data = .,
        family = binomial) %>%
  summary()

# Strength interaction trial*condition
# df3 %>%
#   cb_lf_int() %>%
#   mutate(value = ifelse(condition == "impoverished", value * (-1), value),
#          trial = trial - 17) %>%
#   mutate(value = ifelse(value < 0, 0, value),
#          trial = trial / 100) %>%
#   glmer(value ~ 1 + trial * condition + (1|participant.id),
#         data = .,
#         family = binomial) %>%
#   summary()
df3 %>%
  cb_lf_int() %>%
  mutate(value = ifelse(condition == "impoverished", value * (-1), value),
         trial = trial - 17) %>%
  mutate(value = ifelse(value < 0, 0, value),
         trial = trial / 100) %>%
  glmer(value ~ 1 + (I(trial^2) + trial) * condition + (1|participant.id),
        data = .,
        family = binomial) %>%
  summary()

# "Reversed intercepts"
df3 %>%
  cb_lf_int() %>%
  mutate(value = ifelse(condition == "impoverished", value * (-1), value),
         trial = (trial - 100) * (-1)) %>%
  mutate(value = ifelse(value < 0, 0, value),
         trial = trial / 100) %>%
  filter(condition == "rich") %>%
  glmer(value ~ 1 + trial + (1|participant.id),
        data = .,
        family = binomial) %>%
  summary()
df3 %>%
  cb_lf_int() %>%
  mutate(value = ifelse(condition == "impoverished", value * (-1), value),
         trial = (trial - 100) * (-1)) %>%
  mutate(value = ifelse(value < 0, 0, value),
         trial = trial / 100) %>%
  filter(condition == "impoverished") %>%
  glmer(value ~ 1 + trial + (1|participant.id),
        data = .,
        family = binomial) %>%
  summary()
# df3 %>%
#   cb_lf_int() %>%
#   mutate(value = ifelse(condition == "impoverished", value * (-1), value),
#          trial = (trial - 100) * (-1)) %>%
#   mutate(value = ifelse(value < 0, 0, value),
#          trial = trial / 100) %>%
#   glmer(value ~ 1 + trial * condition + (1|participant.id),
#         data = .,
#         family = binomial) %>%
#   summary()

# Difference between groups on first trial
df3 %>%
  select(condition, primacy, week17) %>%
  mutate(week17 = ifelse(primacy == "A", week17 * (-1), week17)) %>%
  mutate(week17 = ifelse(condition == "impoverished", week17 * (-1), week17)) %$%
  table(week17, condition) %>%
  chisq.test()

# Difference between groups on last trial
df3 %>%
  select(condition, primacy, week100) %>%
  mutate(week100 = ifelse(primacy == "A", week100 * (-1), week100)) %>%
  mutate(week100 = ifelse(condition == "impoverished", week100 * (-1), week100)) %$%
  table(week100, condition) %>%
  chisq.test()







# Oscillation
oscillations(df3) %>%
  group_by(condition) %>%
  summarize(avg = 100 * mean(oscillation),
            sd = 100 * sd(oscillation))

oscillations(df3) %>%
  ggplot(aes(x = time,
             y = oscillation,
             color = condition)) +
  geom_point(size = .9) +
  geom_line(size = .2,
            alpha = .3) +
  geom_smooth(method = "loess",
              span = 1,
              size = 1) +
  scale_color_brewer(palette = "Dark2") +
  theme_apa() +
  labs(y = "Percentage switches",
       x = "Trial")
ggsave("Output/Graphs/Exp2_oscillations.svg", device = "svg")

# Test
ttestBF(subset(oscillations(df3), condition == "impoverished")$oscillation,
        subset(oscillations(df3), condition == "rich")$oscillation,
        nullInterval = c(0, Inf)) %>%
  printBFt()
df3 %>%
  oscillations() %>%
  mutate(condition = factor(condition, levels = c("impoverished", "rich"))) %>%
  ttest(data = .,
        y = oscillation,
        x = condition,
        dir = "greater")

### Relative preference estimates post----

## Continuous

# Graph
df3 %>%
  ggplot(aes(x = condition,
             y = postpref_freq,
             fill = condition)) +
  geom_violin() + 
  geom_boxplot(width = 0.2) +
  geom_jitter(size = 0.5, width = 0.2) +
  geom_hline(yintercept = 0, linetype = 2) +
  scale_fill_brewer(palette = "Dark2") +
  theme_apa() +
  labs(x = "Condition",
       y = "Relative preference estimates - post-measure") +
  theme(legend.position = "none")

# Means and sds
df3 %>%
  group_by(condition) %>%
  summarise(post_avg = printnum(mean(postpref_freq)),
            post_SD = printnum(sd(postpref_freq)))

# Tests
df3 %>%
  filter(condition == "rich") %>%
  as.data.frame() %$%
  ttestBF(postpref_freq,
          mu = 0,
          nullInterval = c(0, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = postpref_freq,
      x = condition,
      mu = 0,
      sub = "rich",
      dir = "greater")

df3 %>%
  filter(condition == "impoverished") %>%
  as.data.frame() %$%
  ttestBF(postpref_freq,
          mu = 0,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = postpref_freq,
      x = condition,
      mu = 0,
      sub = "impoverished",
      dir = "two.sided")

df3 %>%
  as.data.frame() %>%
  ttestBF(data = .,
          formula = postpref_dom ~ condition, # Dominant because imp < 0
          nullInterval = c(0, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = postpref_dom,
      x = condition,
      dir = "greater")

# Graph
df3 %>%
  gather(key = time,
         value = polarity,
         c(prepref_freq, postpref_freq)) %>%
  mutate(time = factor(time,
                       levels = c("prepref_freq", "postpref_freq"),
                       labels = c("pre", "post"))) %>%
  within_ci(.data = .,
             .subject = participant.id,
             .value = polarity,
             .ws_factors = time,
             .bs_factors = condition) %>%
  ggplot(aes(color = condition)) +
  geom_point(aes(x = time,
                 y = sample_mean)) +
  geom_line(aes(x = time,
                y = sample_mean,
                group = condition),
            size = .9) +
  geom_errorbar(width = .1,
                aes(x = time,
                    ymin = sample_mean - CI,
                    ymax = sample_mean + CI)) +
  scale_color_brewer(palette = "Dark2") +
  theme_apa() +
  labs(x = "Measurement point",
       y = "Relative preference estimates")
ggsave("Output/Graphs/Exp2_relprefest.svg", device = "svg")

## Binary

# Graph
df3 %>%
  filter(!is.na(binarypostpref)) %>%
  mutate(binarypostpref = factor(binarypostpref)) %>%
  ggplot(aes(x = binarypostpref,
             group = condition,
             fill = condition)) +
  geom_bar(position = "dodge") +
  scale_fill_brewer(palette = "Dark2") +
  theme_apa()


# Distribution
distrpost <- df3 %$%
  table(binarypostpref, condition)
distrpost
length(which(is.na(df3$binarypostpref))) # excluded from binary analyses

# Tests
proportionBF(y = distrpost["1", "rich"],
             N = distrpost["1", "rich"] + distrpost["0", "rich"],
             p = .5,
             rscale = "ultrawide",
             nullInterval = c(.5, 1)) %>% printBFb
binom.test(x = distrpost["1", "rich"],
           n = distrpost["1", "rich"] + distrpost["0", "rich"],
           p = .5,
           alternative = "greater")

proportionBF(y = distrpost["0", "impoverished"],
             N = distrpost["1", "impoverished"] + distrpost["0", "impoverished"],
             p = .5,
             rscale = "ultrawide",
             nullInterval = c(0, 1)) %>% printBFb
binom.test(x = distrpost["0", "impoverished"],
           n = distrpost["1", "impoverished"] + distrpost["0", "impoverished"],
           p = .5,
           alternative = "greater")

proportionBF(y = distrpost["1", "rich"],
             N = distrpost["1", "rich"] + distrpost["0", "rich"],
             p = distrpost["1", "impoverished"] / (distrpost["1", "impoverished"] + distrpost["0", "impoverished"]),
             rscale = "ultrawide",
             nullInterval = c(.5, 1)) %>% printBFb() # again dominant because imp < 0
binom.test(x = distrpost["1", "rich"],
           n = distrpost["1", "rich"] + distrpost["0", "rich"],
           p = distrpost["1", "impoverished"] / (distrpost["1", "impoverished"] + distrpost["0", "impoverished"]),
           alternative = "greater")


### Conditionals post----

# Graph
df3 %>%
  ggplot(aes(x = condition,
             y = postcond_dp,
             fill = condition)) +
  geom_violin() + 
  geom_boxplot(width = 0.2) +
  geom_jitter(size = 0.5, width = 0.2) +
  geom_hline(yintercept = 0, linetype = 2) +
  scale_fill_brewer(palette = "Dark2") +
  theme_apa() +
  labs(x = "Conditional estimates",
       y = expression(Delta*"p")) +
  theme(legend.position = "none")

# Summary statistics and tests
df3 %>%
  # xpostcond2 -> How likely was it (in %) that you grabbed a *frequent* ball if...
  mutate(frequent = ifelse(primacy == "A", apostcond2, bpostcond2),
         infrequent = ifelse(primacy == "A", bpostcond2, apostcond2)) %>%
  # Summarize
  group_by(condition) %>%
  summarise(winning_bag = printnum(mean(frequent)),
            losing_bag = printnum(mean(infrequent)),
            winning_bag_sd = printnum(sd(frequent)),
            losing_bag_sd = printnum(sd(infrequent)))

df3 %>%
  group_by(condition) %>%
  summarise(post_avg = printnum(mean(postcond_dp)),
            post_SD = printnum(sd(postcond_dp)))

# Tests
df3 %>%
  filter(condition == "rich") %$%
  ttestBF(postcond_dp,
          mu = 0,
          nullInterval = c(0, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = postcond_dp,
      x = condition,
      mu = 0,
      sub = "rich",
      dir = "greater")

df3 %>%
  filter(condition == "impoverished") %$%
  ttestBF(postcond_dp,
          mu = 0,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = postcond_dp,
      x = condition,
      mu = 0,
      sub = "impoverished",
      dir = "two.sided")

df3 %>%
  as.data.frame() %>%
  ttestBF(data = .,
          formula = postcond_dp ~ condition,
          nullInterval = c(0, Inf)) %>%
  printBFt()
ttest(data = df3,
      y = postcond_dp,
      x = condition,
      dir = "greater")

# Graph
df3 %>%
  gather(key = time,
         value = conditionals,
         c(precond_dp, postcond_dp)) %>%
  mutate(time = factor(time,
                       levels = c("precond_dp", "postcond_dp"),
                       labels = c("Pre", "Post"))) %>%
  within_ci(.data = .,
             .subject = participant.id,
             .value = conditionals,
             .ws_factors = time,
             .bs_factors = condition) %>%
  ggplot(aes(color = condition)) +
  geom_point(aes(x = time,
                 y = sample_mean)) +
  geom_line(aes(x = time,
                y = sample_mean,
                group = condition),
            size = .9) +
  geom_errorbar(width = .1,
                aes(x = time,
                    ymin = sample_mean - CI,
                    ymax = sample_mean + CI)) +
  scale_color_brewer(palette = "Dark2") +
  theme_apa() +
  labs(x = "Measurement point",
       y = expression(Delta*"p"))
ggsave("Output/Graphs/Exp2_conditionals.svg", device = "svg")

### Confidence post----

# Means and sds
df3 %>%
  group_by(condition) %>%
  summarise(post_avg = printnum(mean(postconf_dp)),
            post_SD = printnum(sd(postconf_dp)))

# Inference tests
conf <- df3 %>%
  group_by(condition) %>%
  mutate(conf_post_fr = ifelse(primacy == "A", apostconf2, bpostconf2),
         conf_post_in = ifelse(primacy == "A", bpostconf2, apostconf2)) %>%
  ungroup %>%
  select(condition, conf_post_fr, conf_post_in) %>%
  pivot_longer(cols = c(conf_post_fr, conf_post_in),
               names_to = "type",
               values_to = "confidence")
conf %>%
  group_by(type) %>%
  summarize(avg = printnum(mean(confidence)),
            sd = printnum(sd(confidence)))
conf %>%
  as.data.frame() %$%
  ttestBF(data = .,
          formula = confidence ~ type,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
conf %>%
  ttest(data = .,
        y = confidence,
        x = type,
        dir = "two.sided")
rm(conf)

# Per condition
conf %>%
  filter(condition == "rich") %>%
  group_by(type) %>%
  summarize(avg = printnum(mean(confidence)),
            sd = printnum(sd(confidence)))
conf %>%
  filter(condition == "rich") %>%
  as.data.frame() %$%
  ttestBF(data = .,
          formula = confidence ~ type,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
conf %>%
  filter(condition == "rich") %>%
  ttest(data = .,
        y = confidence,
        x = type,
        dir = "two.sided")
rm(conf)

conf %>%
  filter(condition == "impoverished") %>%
  group_by(type) %>%
  summarize(avg = printnum(mean(confidence)),
            sd = printnum(sd(confidence)))
conf %>%
  filter(condition == "impoverished") %>%
  as.data.frame() %$%
  ttestBF(data = .,
          formula = confidence ~ type,
          nullInterval = c(-Inf, Inf)) %>%
  printBFt()
conf %>%
  filter(condition == "impoverished") %>%
  ttest(data = .,
        y = confidence,
        x = type,
        dir = "two.sided")
rm(conf)